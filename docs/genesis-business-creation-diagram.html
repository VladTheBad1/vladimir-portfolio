<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genesis - How Business Creation Actually Works</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #1a202c;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 20px;
            font-size: 1.2em;
        }
        .key-insight {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 40px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
        }
        .diagram-container {
            background: #f7fafc;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 40px;
            overflow-x: auto;
        }
        .section-title {
            color: #2d3748;
            font-size: 1.8em;
            margin-top: 40px;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        .mermaid {
            display: flex;
            justify-content: center;
        }
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }
        .comparison-card {
            padding: 20px;
            border-radius: 12px;
        }
        .comparison-card.myth {
            background: #fee2e2;
            border: 2px solid #ef4444;
        }
        .comparison-card.reality {
            background: #d1fae5;
            border: 2px solid #10b981;
        }
        .comparison-card h3 {
            margin: 0 0 15px 0;
            font-size: 1.3em;
        }
        .comparison-card.myth h3 {
            color: #dc2626;
        }
        .comparison-card.reality h3 {
            color: #059669;
        }
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Monaco', 'Courier New', monospace;
            margin: 20px 0;
        }
        .code-comment {
            color: #94a3b8;
            font-style: italic;
        }
        .step-box {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .step-number {
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 10px;
        }
        .info-box {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        .info-box strong {
            color: #1e40af;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ How Genesis Business Creation ACTUALLY Works</h1>
        <p class="subtitle">The Technical Reality Behind "Launching a Business in 60 Seconds"</p>
        
        <div class="key-insight">
            üí° KEY INSIGHT: We DON'T create separate websites! We have ONE app that shows different content based on subdomain.
        </div>

        <!-- Myth vs Reality -->
        <h2 class="section-title">üé≠ Myth vs Reality</h2>
        <div class="comparison-grid">
            <div class="comparison-card myth">
                <h3>‚ùå What Users Think Happens</h3>
                <ul>
                    <li>Genesis creates a new website</li>
                    <li>Deploys separate hosting</li>
                    <li>Sets up individual database</li>
                    <li>Configures unique server</li>
                    <li>Installs custom code</li>
                    <li>Waits for DNS propagation</li>
                </ul>
            </div>
            <div class="comparison-card reality">
                <h3>‚úÖ What Actually Happens</h3>
                <ul>
                    <li>Insert one database row</li>
                    <li>Subdomain instantly works</li>
                    <li>Same app serves content</li>
                    <li>Shared infrastructure</li>
                    <li>Template switches view</li>
                    <li>No deployment needed!</li>
                </ul>
            </div>
        </div>

        <!-- The Single App Architecture -->
        <h2 class="section-title">1. The ONE App That Powers Everything</h2>
        <div class="diagram-container">
            <div class="mermaid">
graph TB
    subgraph "ONE Next.js Application"
        APP[Single Next.js App<br/>Deployed on Vercel]
        
        subgraph "Routes"
            MARKETING[genesis-franchise.com<br/>Marketing Site]
            DASHBOARD[dashboard.genesis.com<br/>Franchisee Dashboard]
            BUSINESS[*.genesis-businesses.com<br/>ALL Business Sites]
        end
        
        subgraph "Shared Components"
            TEMPLATES[3 Template Components<br/>ResumeBuilder, SocialMedia, Email]
            AUTH[Authentication System]
            PAYMENT[Payment Processing]
            AI[AI Integration]
        end
    end
    
    subgraph "ONE Database"
        DB[(PostgreSQL)]
        BTABLE[businesses table]
        CTABLE[customers table]
        OTABLE[orders table]
    end
    
    subgraph "External Services"
        STRIPE[Stripe API]
        GPT[GPT-4 API]
        EMAIL[Email Service]
    end
    
    APP --> MARKETING
    APP --> DASHBOARD
    APP --> BUSINESS
    
    BUSINESS --> TEMPLATES
    
    APP --> AUTH
    APP --> PAYMENT
    APP --> AI
    
    APP --> DB
    DB --> BTABLE
    DB --> CTABLE
    DB --> OTABLE
    
    PAYMENT --> STRIPE
    AI --> GPT
    APP --> EMAIL

    classDef app fill:#e0e7ff,stroke:#6366f1,stroke-width:3px
    classDef db fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    classDef external fill:#d1fae5,stroke:#10b981,stroke-width:2px
    
    class APP,MARKETING,DASHBOARD,BUSINESS,TEMPLATES,AUTH,PAYMENT,AI app
    class DB,BTABLE,CTABLE,OTABLE db
    class STRIPE,GPT,EMAIL external
            </div>
        </div>
        <div class="info-box">
            <strong>Key Point:</strong> There's only ONE codebase, ONE database, and ONE deployment. Everything else is just routing and filtering!
        </div>

        <!-- How Subdomains Work -->
        <h2 class="section-title">2. The Subdomain Magic</h2>
        <div class="diagram-container">
            <div class="mermaid">
graph LR
    subgraph "Customer Visits"
        V1[resume-pro.genesis-businesses.com]
        V2[social-wizard.genesis-businesses.com]
        V3[email-helper.genesis-businesses.com]
    end
    
    subgraph "DNS (Cloudflare)"
        DNS[*.genesis-businesses.com<br/>CNAME ‚Üí vercel.app]
    end
    
    subgraph "Vercel Edge"
        EDGE[Edge Function<br/>Reads Hostname]
    end
    
    subgraph "Next.js Middleware"
        MW[Extract Subdomain<br/>'resume-pro']
    end
    
    subgraph "Database Query"
        QUERY[SELECT * FROM businesses<br/>WHERE subdomain = 'resume-pro']
    end
    
    subgraph "Render Template"
        RENDER[Show Resume Template<br/>With Business Branding]
    end
    
    V1 --> DNS
    V2 --> DNS
    V3 --> DNS
    
    DNS --> EDGE
    EDGE --> MW
    MW --> QUERY
    QUERY --> RENDER

    classDef visit fill:#e0f2fe,stroke:#0ea5e9,stroke-width:2px
    classDef dns fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    classDef process fill:#e0e7ff,stroke:#6366f1,stroke-width:2px
    
    class V1,V2,V3 visit
    class DNS dns
    class EDGE,MW,QUERY,RENDER process
            </div>
        </div>

        <div class="code-block">
// middleware.ts - This is the ENTIRE "magic"
export function middleware(request: Request) {
  const hostname = request.headers.get('host') || ''
  
  <span class="code-comment">// Check if it's a business subdomain</span>
  if (hostname.includes('genesis-businesses.com')) {
    const subdomain = hostname.split('.')[0]  <span class="code-comment">// 'resume-pro'</span>
    
    <span class="code-comment">// Just rewrite the URL internally - no redirect!</span>
    return NextResponse.rewrite(
      new URL(`/business?subdomain=${subdomain}`, request.url)
    )
  }
}
        </div>

        <!-- Business Creation Process -->
        <h2 class="section-title">3. The "Business Creation" Process (It's Just a Database Insert!)</h2>
        <div class="diagram-container">
            <div class="mermaid">
sequenceDiagram
    participant User
    participant Frontend
    participant API
    participant Database
    participant Stripe
    participant Result

    User->>Frontend: Fills form & pays $99
    Frontend->>Stripe: Process payment
    Stripe-->>Frontend: Payment confirmed ‚úì
    
    Frontend->>API: Create business request
    Note over API: Validate subdomain availability
    
    API->>Database: INSERT INTO businesses<br/>(subdomain, template, franchisee_id)
    Database-->>API: Row created (10ms)
    
    API->>Database: INSERT INTO customization<br/>(colors, logo, tagline)
    Database-->>API: Customization saved (5ms)
    
    API->>Stripe: Create Connect Account<br/>(for revenue sharing)
    Stripe-->>API: Account created
    
    API-->>Frontend: Success response
    Frontend-->>User: "Your business is LIVE!"
    
    Note over Result: resume-pro.genesis-businesses.com<br/>IMMEDIATELY WORKS!
    
    User->>Result: Visits their new site
    Result-->>User: Shows their business<br/>(using shared app + template)
            </div>
        </div>

        <!-- The Database Magic -->
        <h2 class="section-title">4. The Database Structure (Multi-Tenant Magic)</h2>
        <div class="diagram-container">
            <div class="mermaid">
graph TB
    subgraph "businesses table"
        B1[id: uuid-1<br/>subdomain: 'resume-pro'<br/>template: 'resume-builder'<br/>franchisee_id: user-123]
        B2[id: uuid-2<br/>subdomain: 'social-wizard'<br/>template: 'social-media'<br/>franchisee_id: user-456]
        B3[id: uuid-3<br/>subdomain: 'email-helper'<br/>template: 'email-assistant'<br/>franchisee_id: user-789]
    end
    
    subgraph "customers table (filtered by business_id)"
        C1[business_id: uuid-1<br/>email: john@example.com<br/>subscription: active]
        C2[business_id: uuid-1<br/>email: jane@example.com<br/>subscription: active]
        C3[business_id: uuid-2<br/>email: bob@example.com<br/>subscription: trial]
    end
    
    subgraph "orders table (filtered by business_id)"
        O1[business_id: uuid-1<br/>amount: $29<br/>genesis_fee: $11.60<br/>franchisee_revenue: $17.40]
        O2[business_id: uuid-2<br/>amount: $49<br/>genesis_fee: $19.60<br/>franchisee_revenue: $29.40]
    end
    
    B1 --> C1
    B1 --> C2
    B2 --> C3
    B1 --> O1
    B2 --> O2

    classDef business fill:#e0e7ff,stroke:#6366f1,stroke-width:2px
    classDef customer fill:#d1fae5,stroke:#10b981,stroke-width:2px
    classDef order fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    
    class B1,B2,B3 business
    class C1,C2,C3 customer
    class O1,O2 order
            </div>
        </div>

        <div class="info-box">
            <strong>Row-Level Security:</strong> Each franchisee can only see data where business_id matches their business. Complete isolation with zero additional infrastructure!
        </div>

        <!-- Template System -->
        <h2 class="section-title">5. How Templates Work (Just React Components!)</h2>
        <div class="diagram-container">
            <div class="mermaid">
graph TB
    subgraph "Request Flow"
        REQ[Customer visits:<br/>resume-pro.genesis-businesses.com]
        CHECK[Check subdomain: 'resume-pro']
        FETCH[Fetch from DB:<br/>template = 'resume-builder']
    end
    
    subgraph "Template Selection"
        SWITCH[Switch Statement]
        T1[ResumeBuilderTemplate]
        T2[SocialMediaTemplate]
        T3[EmailAssistantTemplate]
    end
    
    subgraph "Render with Customization"
        CUSTOM[Apply Business Settings:<br/>- Name: Resume Pro<br/>- Color: #667eea<br/>- Tagline: AI-Powered<br/>- Price: $29/mo]
        RENDER[Final Rendered Page]
    end
    
    REQ --> CHECK
    CHECK --> FETCH
    FETCH --> SWITCH
    
    SWITCH -->|template='resume-builder'| T1
    SWITCH -->|template='social-media'| T2
    SWITCH -->|template='email-assistant'| T3
    
    T1 --> CUSTOM
    CUSTOM --> RENDER

    classDef request fill:#fee2e2,stroke:#ef4444,stroke-width:2px
    classDef template fill:#e0e7ff,stroke:#6366f1,stroke-width:2px
    classDef render fill:#d1fae5,stroke:#10b981,stroke-width:2px
    
    class REQ,CHECK,FETCH request
    class SWITCH,T1,T2,T3 template
    class CUSTOM,RENDER render
            </div>
        </div>

        <div class="code-block">
// app/business/page.tsx - The ENTIRE business rendering logic
export default async function BusinessPage() {
  const subdomain = getSubdomain()  <span class="code-comment">// 'resume-pro'</span>
  
  <span class="code-comment">// Get business from database</span>
  const business = await db.query(
    'SELECT * FROM businesses WHERE subdomain = $1',
    [subdomain]
  )
  
  <span class="code-comment">// Select template component</span>
  const templates = {
    'resume-builder': ResumeBuilderTemplate,
    'social-media': SocialMediaTemplate,
    'email-assistant': EmailAssistantTemplate
  }
  
  const Template = templates[business.template]
  
  <span class="code-comment">// Render with customization</span>
  return &lt;Template business={business} /&gt;
}
        </div>

        <!-- The Complete Flow -->
        <h2 class="section-title">6. The Complete User Journey (Technical View)</h2>
        <div class="diagram-container">
            <div class="mermaid">
graph TB
    START[User: I want to start a business] --> APPLY[Fill application form]
    APPLY --> PAY[Pay $99 via Stripe]
    PAY --> SETUP[Choose: Name, Template, Colors]
    
    SETUP --> INSERT[Database: INSERT INTO businesses]
    INSERT --> INSTANT[‚ú® Business is LIVE ‚ú®<br/>0 deployment time]
    
    INSTANT --> SHARE[User shares link:<br/>resume-pro.genesis-businesses.com]
    
    SHARE --> CUSTOMER[Customer visits site]
    CUSTOMER --> MW[Middleware reads subdomain]
    MW --> DB[Query database for business]
    DB --> TEMPLATE[Load template component]
    TEMPLATE --> SHOW[Show customized business site]
    
    SHOW --> BUY[Customer buys service $29]
    BUY --> SPLIT[Payment splits:<br/>60% Franchisee<br/>40% Genesis]
    
    SPLIT --> PAYOUT[Weekly payout to franchisee]

    classDef user fill:#e0f2fe,stroke:#0ea5e9,stroke-width:3px
    classDef instant fill:#fef3c7,stroke:#f59e0b,stroke-width:3px
    classDef money fill:#d1fae5,stroke:#10b981,stroke-width:3px
    
    class START,APPLY,PAY,SETUP,SHARE user
    class INSERT,INSTANT instant
    class BUY,SPLIT,PAYOUT money
            </div>
        </div>

        <!-- Why This Works -->
        <h2 class="section-title">7. Why This Architecture is Genius</h2>
        <div class="step-box">
            <h3><span class="step-number">1</span>Zero Marginal Cost</h3>
            <p>Adding a new business is just a database row. No new servers, no new code, no new deployment.</p>
        </div>
        
        <div class="step-box">
            <h3><span class="step-number">2</span>Instant "Deployment"</h3>
            <p>Since nothing needs to be deployed, businesses are live the moment the database insert completes (milliseconds).</p>
        </div>
        
        <div class="step-box">
            <h3><span class="step-number">3</span>One Codebase to Rule Them All</h3>
            <p>Fix a bug once, all businesses get the fix. Add a feature once, all businesses can use it.</p>
        </div>
        
        <div class="step-box">
            <h3><span class="step-number">4</span>Infinite Scale</h3>
            <p>The same infrastructure that handles 10 businesses can handle 10,000. Just add more database connections.</p>
        </div>

        <!-- Cost Breakdown -->
        <h2 class="section-title">8. The Economics (Why We Can Offer This for $99)</h2>
        <div class="diagram-container">
            <div class="mermaid">
graph LR
    subgraph "Cost Per Business"
        SETUP[$99 Setup Fee]
        COSTS[Monthly Costs:<br/>Database row: $0.001<br/>Subdomain DNS: $0<br/>Storage: $0.01<br/>Compute share: $0.10]
        TOTAL[Total Cost: ~$0.11/month]
    end
    
    subgraph "Revenue Per Business"
        AVG[Average Business:<br/>10 customers √ó $29<br/>= $290/month]
        SHARE[Genesis Share (40%):<br/>= $116/month]
        PROFIT[Profit Margin:<br/>$116 - $0.11<br/>= $115.89/month]
    end
    
    SETUP --> COSTS
    COSTS --> TOTAL
    TOTAL --> PROFIT
    AVG --> SHARE
    SHARE --> PROFIT

    classDef cost fill:#fee2e2,stroke:#ef4444,stroke-width:2px
    classDef revenue fill:#d1fae5,stroke:#10b981,stroke-width:2px
    
    class SETUP,COSTS,TOTAL cost
    class AVG,SHARE,PROFIT revenue
            </div>
        </div>

        <div class="key-insight" style="margin-top: 40px;">
            üéØ SUMMARY: We're not creating businesses. We're creating database rows that our single app knows how to display differently.
            <br><br>
            This is EXACTLY how Shopify, Substack, WordPress.com, and every successful SaaS platform works!
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#fff',
                primaryBorderColor: '#5a67d8',
                lineColor: '#5a67d8',
                secondaryColor: '#48bb78',
                tertiaryColor: '#ed8936'
            }
        });
    </script>
</body>
</html>